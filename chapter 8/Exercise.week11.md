# æžå®¢æ—¶é—´ã€Šæž¶æž„å¸ˆè®­ç»ƒè¥ã€‹ç¬¬åä¸€å‘¨è¯¾åŽä½œä¸š

## ç¬¬ä¸€é¢˜

> å¯¼è‡´ç³»ç»Ÿä¸å¯ç”¨çš„åŽŸå› æœ‰å“ªäº›ï¼Ÿä¿éšœç³»ç»Ÿç¨³å®šé«˜å¯ç”¨çš„æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿè¯·åˆ†åˆ«åˆ—ä¸¾å¹¶ç®€è¿°ã€‚

### å¼•èµ·æ•…éšœçš„ä¸»è¦åŽŸå› 

- ç¡¬ä»¶æ•…éšœ
- è½¯ä»¶ bug
- ç³»ç»Ÿå‘å¸ƒ
- å¹¶å‘åŽ‹åŠ›
- ç½‘ç»œæ”»å‡»
- å¤–éƒ¨ç¾å®³

### é«˜å¯ç”¨æž¶æž„

- æé«˜ä»£ç å¯ç”¨æ€§

  - é«˜å†…èšã€ä½Žè€¦åˆç»„ä»¶è®¾è®¡
  - é¢å‘å¯¹è±¡è®¾è®¡
  - DDD å»ºæ¨¡

- ä½¿ç”¨æœåŠ¡é›†ç¾¤

  å‡è®¾åªæœ‰ä¸€å°æœåŠ¡å™¨æ‰§è¡Œæ‰€æœ‰åº”ç”¨ï¼Œåªè¦æœ‰äººä¸å°å¿ƒè¸©åˆ°äº†ç”µæºæ’å¤´ï¼Œå°±å¯ä»¥å¯¼è‡´æ•´ä¸ªæœåŠ¡å®•æœºã€‚é€šå¸¸ç³»ç»Ÿè®¾è®¡æ—¶é€šå¸¸ä¼šå°†åº”ç”¨éƒ¨ç½²åˆ°ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼šè‹¥ä¸€å°æœåŠ¡å™¨å®•æœºçš„æ¦‚çŽ‡ä¸º 10%ï¼Œå³å¯ç”¨æ€§ä¸º 90% ï¼›ä¸‰å°åŒæ ·çš„æœåŠ¡å™¨çš„å¯ç”¨æ€§å°±å¯ä»¥æé«˜åˆ° `1 - 10% ^3 = 99.9%`ï¼Œå¯ç”¨æ€§æ˜Žæ˜¾ä¸Šå‡ã€‚å½“ç„¶ï¼ŒæœåŠ¡é›†ç¾¤æ„å‘³ç€æ›´é«˜çš„ç¡¬ä»¶æˆæœ¬ï¼ŒçŽ°åœ¨æ¯”è¾ƒæµè¡Œè™šæ‹ŸåŒ–å®¹å™¨ç­‰æŠ€æœ¯é™ä½Žæˆæœ¬ã€‚

- æ— çŠ¶æ€ç»„ä»¶

  éƒ¨ç½²æœåŠ¡é›†ç¾¤æ˜¯ä¿è¯é«˜å¯ç”¨çš„æœ€åŸºæœ¬éœ€æ±‚ï¼šç¡®ä¿ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥æ–­è¿žã€å…³æœºã€å‡çº§ï¼Œä½†æ˜¯å‰©ä½™çš„æœåŠ¡ä¾æ—§æ­£å¸¸å·¥ä½œã€‚åº”ç”¨é›†ç¾¤ä¸€èˆ¬è®¾è®¡ä¸ºæ— çŠ¶æ€æœåŠ¡ï¼Œé€šè¿‡ Sessionã€cache æˆ–æ˜¯æ•°æ®åº“å…±äº«ä¿¡æ¯ã€‚

- Load Balancing

  è´Ÿè½½å‡è¡¡æ—¢æ˜¯åº”å¯¹ç½‘ç»œå¹¶å‘åŽ‹åŠ›çš„è§£å†³æ–¹æ¡ˆï¼Œä¹Ÿå¯ä»¥åœ¨æ£€æµ‹åˆ°æŸå®žä¾‹æ•…éšœæ—¶ï¼Œæ— ç¼åˆ‡æ¢æµé‡ï¼Œæé«˜ç³»ç»Ÿå®¹é”™èƒ½åŠ›ã€‚

- é™çº§ã€ç†”æ–­ã€é™æµ

  - é™çº§ä¹Ÿå°±æ˜¯å½“æˆ‘ä»¬çš„æœåŠ¡å™¨åŽ‹åŠ›å‰§å¢žä¸ºäº†ä¿è¯æ ¸å¿ƒåŠŸèƒ½çš„å¯ç”¨æ€§ï¼Œè€Œé€‰æ‹©æ€§çš„é™ä½Žæˆ–æ˜¯ç›´æŽ¥å…³é—­ä¸€äº›æ¬¡è¦åŠŸèƒ½
  - ç†”æ–­ä¸€èˆ¬æ˜¯æŒ‡ä¾èµ–çš„å¤–éƒ¨æŽ¥å£å‡ºçŽ°æ•…éšœçš„æƒ…å†µæ–­ç»å’Œå¤–éƒ¨æŽ¥å£çš„è”ç³»
  - é™æµä¹Ÿå°±æ˜¯ç³»ç»Ÿè§„å®šäº†å¤šå°‘æ‰¿å—èƒ½åŠ›ï¼Œåªå…è®¸è¿™ä¹ˆäº›è¯·æ±‚èƒ½è¿‡æ¥ï¼Œæ‹’ç»è¶…è½½è¯·æ±‚

- æ•°æ®å¤‡ä»½ã€æ¢å¤

  æ•°æ®åº“å¥”æºƒæ¯”æœåŠ¡å™¨å®•æœºå±å®³æ›´å¤§ï¼Œå› ä¸ºç”¨æˆ·çš„æ•°æ®å¾ˆå¯èƒ½ä¼šå°±æ­¤ä¸¢å¤±ï¼ŒåŽæžœä¸å ªè®¾æƒ³ã€‚æ•°æ®åº“å†—ä½™å¤‡ä»½æ˜¯ç³»ç»Ÿè®¾è®¡æ—¶å¿…é¡»çš„è€ƒé‡ã€‚æ¯ä¸ªæ•°æ®ä¸­å¿ƒéƒ½åº”è¯¥å…·æœ‰å®Œæ•´çš„å¤‡ä»½ï¼Œå¹¶äº‹å…ˆè®¡åˆ’å¥½æ•°æ®ä¸¢å¤±å’Œæ¢å¤çš„ç­–ç•¥ã€‚

- Failover

  å¤±æ•ˆè½¬ç§»æŒ‡çš„æ˜¯å½“ä¸»è¦ç»„ä»¶å¼‚å¸¸æ—¶ï¼Œå…¶åŠŸèƒ½è½¬ç§»åˆ°å¤‡ä»½ç»„ä»¶ã€‚å…¶è¦ç‚¹åœ¨äºŽæœ‰ä¸»æœ‰å¤‡ï¼Œä¸”ä¸»æ•…éšœæ—¶å¤‡å¯å¯ç”¨å¹¶è®¾ç½®ä¸ºä¸»ã€‚é€šå¸¸çš„å®žçŽ°æ‰‹æ®µæœ‰ï¼šä¸»ä»Žå¤åˆ¶ã€ä¸»ä¸»å¤åˆ¶ï¼Œä¹Ÿå¯ä»¥ç»“åˆæ•°æ®åˆ†ç‰‡ç­‰ç­‰æŠ€æœ¯ã€‚

- å¼‚åœ°å¤šæ´»

  æœåŠ¡é›†ç¾¤ã€æ•°æ®åº“æ‰©å±•åŽï¼Œæœ‰äº›å®‰å…¨éšæ‚£ä¾æ—§ä¸å¯é¿å…ï¼Œæ¯”å¦‚åœ°éœ‡ã€ç«ç¾è¿™ç±»è‡ªç„¶ç¾å®³å¾ˆå¯èƒ½å¯¼è‡´æ•´ä¸ªæœºæˆ¿é­é‡é‡å¤§ç ´åã€‚ä¸ºäº†é¿å…è¿™ç±»äº‹æ•…ï¼Œä¸€èˆ¬ä¼šåœ¨å¤šåœ°éƒ¨ç½²æœºæˆ¿ï¼Œå®žçŽ°å¼‚åœ°å®¹ç¾å®¹é”™ã€‚å½“ç„¶åœ°çƒçˆ†ç‚¸æ—¶ï¼Œå¼‚åœ°å¤šæ´»ä¹Ÿä¼šå¤±æ•ˆï¼Œæ‰€ä»¥ä»¥é˜²ä¸‡ä¸€æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†æœåŠ¡éƒ¨ç½²åœ¨å«æ˜Ÿä¸Š ðŸ˜…

- æ•…éšœæ¢å¤è®¡åˆ’

  å¦‚ä¸Šçš„æž¶æž„è®¾è®¡ä»…ä»…æ˜¯æé«˜ç³»ç»Ÿçš„å¯ç”¨æ€§ï¼Œä½†ä¾æ—§ä¸å¯èƒ½å®Œå…¨é¿å…æ•…éšœäº§ç”Ÿã€‚å› è€Œè¿˜å¾—å»ºç«‹ä¸€å¥—ç³»ç»Ÿçš„æ•…éšœæ¢å¤æµç¨‹ï¼š

  - èƒ½åŠæ—¶åœ°éš”ç¦»æ•…éšœè®¾å¤‡ï¼Œç¡®ä¿å‰©ä½™ç³»ç»ŸåŠŸèƒ½æ­£å¸¸
  - å»ºç«‹æ•…éšœåŽ†å²è®°å½•ï¼Œå¹¶è¿½è¸ªé—®é¢˜æ ¹æº
  - é€šè¿‡ç›‘æŽ§ç³»ç»Ÿæ”¶é›†è´Ÿè½½æ•°æ®å¹¶åˆ†æžè¶‹åŠ¿
  - å»ºç«‹ä¸€ç³»åˆ—æ¢å¤æ‰‹å†Œï¼Œå¹¶å®šæœŸæµ‹è¯•å…¶å®žç”¨æ€§
  - å‘˜å·¥åŸ¹è®­ï¼Œä»¥æé«˜è®¾è®¡ã€éƒ¨ç½²ã€è¿ç»´çš„èƒ½åŠ›
  - è¿˜åº”åˆ¶å®šå®‰å…¨ç­–ç•¥ï¼ŒæŠ‘åˆ¶å®‰å…¨æ¼æ´žâ€¦â€¦

## ç¬¬äºŒé¢˜

> è¯·ç”¨ä½ ç†Ÿæ‚‰çš„è¯­è¨€å†™ä¸€ä¸ªç”¨æˆ·å¯†ç éªŒè¯å‡½æ•°ï¼Œ`Boolean checkPW(String ç”¨æˆ·ID, String å¯†ç æ˜Žæ–‡, String å¯†ç å¯†æ–‡)`ï¼Œ è¿”å›žå¯†ç æ˜¯å¦æ­£ç¡® boolean å€¼ï¼Œå¯†ç åŠ å¯†ç®—æ³•ä½¿ç”¨ä½ è®¤ä¸ºè®¤ä¸ºåˆé€‚çš„åŠ å¯†ç®—æ³•ã€‚

è¿™é¢˜ä½“é¢å¤ªç®€æ´äº†ï¼Œæˆ‘éƒ½ä¸çŸ¥é“æ€Žä¹ˆå¤šå†™ç‚¹å­—äº† ðŸ˜…

é€šå¸¸æ¥è¯´å¦‚æžœä¸¤ä¸ªç”¨æˆ·å¯†ç ç›¸åŒï¼Œé‚£ä¹ˆä»–ä»¬å¯†ç çš„å•å‘æ•£åˆ—ä¹‹åŽçš„å“ˆå¸Œå€¼ä¹Ÿæ˜¯ç›¸åŒçš„ã€‚å› è€Œå‡ºçŽ°äº†ä¸€ç§å«â€œæŸ¥è¡¨æ³•â€çš„ç®—æ³•ç ´è§£å“ˆå¸Œå¯†ç ï¼Œä¸»è¦çš„æ€æƒ³å°±æ˜¯é¢„è®¡ç®—å¯†ç å­—å…¸ä¸­çš„æ¯ä¸ªå¯†ç ï¼Œç„¶åŽæŠŠå“ˆå¸Œå€¼å’Œå¯¹åº”çš„å¯†ç å‚¨å­˜åˆ°ä¸€ä¸ªç”¨äºŽå¿«é€ŸæŸ¥è¯¢çš„æ•°æ®ç»“æž„ä¸­ã€‚ä½†æ˜¯æŸ¥è¡¨æ³•åªæœ‰åœ¨æ‰€æœ‰å¯†ç éƒ½ä»¥ç›¸åŒæ–¹å¼è¿›è¡Œå“ˆå¸ŒåŠ å¯†æ—¶æ‰æœ‰æ•ˆï¼›æˆ‘ä»¬å¯ä»¥é€šè¿‡â€œéšæœºåŒ–â€å“ˆå¸Œæ¥é˜»æ­¢è¿™ç±»æ”»å‡»ï¼ŒäºŽæ˜¯å½“ç›¸åŒçš„å¯†ç è¢«å“ˆå¸Œä¸¤æ¬¡ä¹‹åŽï¼Œå¾—åˆ°çš„å€¼å°±ä¸ç›¸åŒäº†ã€‚æ¯”å¦‚å¯ä»¥åœ¨å¯†ç ä¸­æ··å…¥ä¸€æ®µâ€œéšæœºâ€çš„å­—ç¬¦ä¸²å†è¿›è¡Œå“ˆå¸ŒåŠ å¯†ï¼Œè¿™ç§å­—ç¬¦ä¸²è¢«ç§°ä½œç›å€¼ã€‚

ç›å€¼æ˜¯å¯ä»¥è¢«æš´éœ²ï¼Œä½†æ˜¯è¦ä¿è¯æ¯ä¸ªç”¨æˆ·å”¯ä¸€ï¼Œè€Œä¸”ä¸è¦å¤ªçŸ­ï¼š

- ç”¨ç›¸åŒçš„ç›ï¼Œæ„å‘³ç€ç›¸åŒçš„å¯†ç åˆå¾—åˆ°äº†ç›¸åŒçš„æ•£åˆ—å€¼ï¼Œæ— æ³•å¯¹æŠ—â€œæŸ¥è¡¨æ³•â€ã€‚æœ‰äº›ç®—æ³•åŒ…è£¹äº†å¥½å‡ å±‚çš„æ•£åˆ—ç®—æ³•äº‹å®žä¸Šæ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚
- ç›å¤ªçŸ­ï¼Œåˆå®¹æ˜“æš´åŠ›ç ´è§£ï¼Œå®‰å…¨æ€§åˆä¸å¤Ÿç”¨äº†

æˆ‘è¿™é‡Œå›¾ç®€å•å°±ç›´æŽ¥ç”¨äº† userId ä½œç›äº†â€”â€”userId å³å”¯ä¸€ï¼Œé€šå¸¸åˆä¸è‡³äºŽå¾ˆçŸ­ã€‚ç®—æ³•ä¹Ÿéžå¸¸ç®€å•ç›´æŽ¥`å¯†ç +ç›`åš md5 æ•£åˆ—ï¼š

```typescript
import * as md5 from 'md5'
import express = require('express');
import UserDao from './userDao';

function encrypt(userId: string, plaintext: string): string {
  return md5(plaintext+userId);
}

function checkPW(userId: string, plaintext: string, ciphertext: string): boolean {
  return encrypt(userId, plaintext) === ciphertext;
}

const app: express.Application = express();

app.post('/register', async (req: express.Request, res: express.Response) => {
  const {userId, password} = req.body;
  const ciphertext: string = encrypt(userId, password);
  const ret: boolean = await UserDao.save({userId, pwd: ciphertext});
  res.send(ret);
});

app.post('/login', async (req: express.Request, res: express.Response) => {
  const {userId, password} = req.body;
  const {pwd: ciphertext} = await UserDao.get(userId);
  const isValidUser: checkPW(userId, password, ciphertext);
  res.send(isValidUser);
});
```
